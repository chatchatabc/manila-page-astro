---
import Layout from "@layouts/layout.astro";
import { Img } from "astro-imagetools/components";
import { getCollection } from "astro:content";
import { Icon } from "astro-icon";
import { utilRemoveTrailSlash } from "src/utils/commonUtils";

const placesCollection = await getCollection("places");

const { pathname } = Astro.url;
const fixedPathname = utilRemoveTrailSlash(pathname);
---

<Layout>
  <!-- Hero Section -->
  <section class="relative">
    <div class="overflow-hidden h-[80vh] lg:h-[90vh]">
      <Img
        src="/images/places/rizal-park.png"
        alt="Rizal Park"
        objectPosition="50% 100%"
      />
    </div>

    <div
      class="absolute left-0 top-0 bg-gradient-to-b from-cl via-transparent to-cd h-full w-full"
    >
    </div>

    <div class="absolute bottom-0 pb-[10%] w-full">
      <div class="absolute w-full h-full">
        <div
          class="absolute left-0 w-1/2 h-full bg-cd opacity-70 triangle-side-clip"
        >
        </div>
        <div
          class="absolute left-1/2 -translate-x-1/2 bottom-0 w-full h-1/2 bg-cl triangle-clip"
        >
        </div>
        <div
          class="absolute right-0 w-1/2 h-full bg-cd opacity-70 triangle-side-clip rotate-180"
        >
        </div>
      </div>
    </div>
  </section>

  <section class="container mx-auto px-4 space-y-12 pb-16 lg:px-8">
    <!-- Featured Section -->
    <section class="relative lg:-mt-8">
      <!-- Section Title -->
      <header>
        <h2 class="text-5xl font-play font-bold text-cd text-center">
          Featured Places
        </h2>
        <p class="text-gray-900 text-lg text-center">
          Discover the best places to visit in Metro Manila.
        </p>
      </header>

      <!-- Items -->
      <ul class="flex-wrap justify-center mt-4 md:flex">
        {
          [...placesCollection].splice(0, 3).map((place) => {
            return (
              <li class="p-1 w-full flex-shrink-0 md:w-1/2 lg:w-1/3 xl:p-2">
                <figure class="bg-white text-black rounded-xl group">
                  <div class="relative pb-[65%] overflow-hidden rounded-xl">
                    <div class="absolute top-0 left-0 w-full h-full duration-500 group-hover:scale-110">
                      <Img
                        src={place.data.featuredImage}
                        alt={place.data.title}
                      />
                    </div>

                    <div class="absolute bottom-0 w-full text-white pb-1 pt-4 px-2 bg-gradient-to-t from-black to-transparent bg-opacity-50">
                      <h2 class="text-3xl font-alex line-clamp-2">
                        {place.data.title}
                      </h2>
                    </div>
                  </div>
                  <figcaption class="relative p-4">
                    <p class="line-clamp-4">{place.data.summary}</p>
                    <a
                      href={`${fixedPathname}/${place.slug}`}
                      class="mt-4 bg-ac1 text-white mx-auto block w-fit px-4 py-1 rounded-md"
                    >
                      View more
                    </a>
                  </figcaption>
                </figure>
              </li>
            );
          })
        }
      </ul>
    </section>

    <!-- Museums Section -->
    <section>
      <!-- Section Title -->
      <header>
        <h2 class="text-5xl text-cd font-bold font-play text-center">
          Museums for All Ages
        </h2>
        <p class="text-gray-900 text-lg text-center">
          From contemporary art to natural history, and everything in between,
          there's a museum for every interest.
        </p>
      </header>

      <!-- Items -->
      <ul class="flex-wrap justify-center mt-4 md:flex">
        {
          [...placesCollection]
            .filter((place) => place.data.categories.includes("museum"))
            .splice(0, 4)
            .map((place) => {
              return (
                <li class="p-1 w-full flex-shrink-0 md:w-1/2 lg:w-1/4 xl:p-2">
                  <a href={`${fixedPathname}/${place.slug}`}>
                    <figure class="relative bg-white rounded-xl overflow-hidden group">
                      <div class="relative pb-[65%]">
                        <div class="absolute top-0 left-0 w-full h-full duration-500 group-hover:scale-110">
                          <Img
                            src={place.data.featuredImage}
                            alt={place.data.title}
                          />
                        </div>
                      </div>
                      <figcaption>
                        <div class="absolute bottom-0 w-full text-white pb-1 pt-4 px-2 bg-gradient-to-t from-black to-transparent">
                          <h2 class="text-3xl font-alex line-clamp-2">
                            {place.data.title}
                          </h2>
                        </div>
                      </figcaption>
                    </figure>
                  </a>
                </li>
              );
            })
        }
      </ul>
    </section>

    <!-- Intramuros Section -->
    <section class="bg-white rounded-xl overflow-hidden flex flex-wrap">
      <!-- Left -->
      <section
        class="flex flex-col justify-center w-full p-8 md:p-12 lg:p-16 lg:w-1/3"
      >
        <!-- Section Title -->
        <header>
          <h2 class="text-5xl font-play font-bold text-cd">
            Rich History of Intramuros
          </h2>
        </header>
        <p class="text-black mt-8">
          Discover the ancient walls, the grand colonial architecture, and the
          historic landmarks that shaped the city's past.
        </p>
      </section>

      <!-- Right -->
      <section class="bg-bg1 w-full lg:w-2/3">
        <ul class="flex flex-wrap">
          {
            [...placesCollection]
              .filter((place) => place.data.categories.includes("intramuros"))
              .map((place) => {
                return (
                  <li class="p-2 w-full md:w-1/2">
                    <a href={`${fixedPathname}/${place.slug}`}>
                      <figure class="relative pb-[60%] rounded-xl overflow-hidden group">
                        <div class="absolute w-full h-full duration-500 group-hover:scale-110">
                          <Img
                            src={place.data.featuredImage}
                            alt={place.data.title}
                          />
                          <div class="bg-gradient-to-t from-black to-transparent absolute bottom-0 left-0 h-1/2 w-full" />
                        </div>

                        <figcaption class="absolute bottom-0 w-full text-white p-1">
                          <header>
                            <h2 class="text-xl text-center">
                              {place.data.title}
                            </h2>
                          </header>
                          <p class="text-xs text-center font-medium flex justify-center">
                            <Icon
                              name="ic:baseline-location-on"
                              class="w-4 h-4"
                            />
                            <span>{place.data.location}</span>
                          </p>
                        </figcaption>
                      </figure>
                    </a>
                  </li>
                );
              })
          }
        </ul>
      </section>
    </section>

    <!-- Market Section -->
    <section>
      <!-- Section Title -->
      <header>
        <h2 class="text-5xl font-play text-cd font-bold text-center">
          Metro Manila Market Adventures
        </h2>
        <p class="text-gray-900 text-center">
          Immerse yourself in the vibrant and colorful world of Metro Manila's
          marketplaces.
        </p>
      </header>

      <!-- Items -->
      <ul class="flex-wrap justify-center mt-4 md:flex">
        {
          [...placesCollection]
            .filter((place) => place.data.categories.includes("market"))
            .splice(0, 3)
            .map((place) => {
              return (
                <li class="p-1 w-full flex-shrink-0 md:w-1/2 lg:w-1/3 xl:p-2">
                  <figure class="bg-white text-black rounded-xl group">
                    <div class="relative pb-[65%] overflow-hidden rounded-xl">
                      <div class="absolute top-0 left-0 w-full h-full duration-500 group-hover:scale-110">
                        <Img
                          src={place.data.featuredImage}
                          alt={place.data.title}
                        />
                      </div>

                      <div class="absolute bottom-0 w-full text-white pb-1 pt-4 px-2 bg-gradient-to-t from-black to-transparent bg-opacity-50">
                        <h2 class="text-3xl font-alex line-clamp-2">
                          {place.data.title}
                        </h2>
                      </div>
                    </div>
                    <figcaption class="relative p-4">
                      <p class="line-clamp-4">{place.data.summary}</p>
                      <a
                        href={`${fixedPathname}/${place.slug}`}
                        class="mt-4 bg-ac1 text-white mx-auto w-fit block px-4 py-1 rounded-md"
                      >
                        View more
                      </a>
                    </figcaption>
                  </figure>
                </li>
              );
            })
        }
      </ul>
    </section>
  </section>
</Layout>

---
import Layout from "@layouts/layout.astro";
import { Img } from "astro-imagetools/components";
import { getCollection } from "astro:content";

const placesCollection = await getCollection("places");
const tripsCollection = await getCollection("trips");
---

<Layout>
  <!-- Hero Section -->
  <section class="h-screen max-h-[600px] relative">
    <!-- Background Image -->
    <Img objectPosition="50% 75%" src="/images/hero-bg.jpg" alt="" />

    <!-- Wave -->
    <div class="w-full absolute bottom-0 translate-y-1/2 z-[1]">
      <div class="top-0 left-0 absolute w-full h-full">
        <img class="w-full h-full object-cover" src="/images/wave.svg" alt="" />
      </div>
      <h1
        class="text-[#CCE919] relative text-center font-alex text-3xl pt-32 pb-24 px-4 lg:px-8 lg:text-5xl lg:pt-24 lg:pb-16"
      >
        Explore Destinations and Invite Friends & Plan Together
      </h1>
    </div>
  </section>

  <!-- Places to Visit -->
  <section id="places-to-visit" class="relative pt-24">
    <div class="mx-auto container relative overflow-x-hidden">
      <div
        class="bg-background h-24 absolute w-[125%] top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 rounded-[50%]"
      >
      </div>
      <ul class="flex snap-x overflow-x-auto">
        {
          placesCollection.map((place) => {
            const { title, summary, featuredImage } = place.data;
            return (
              <li class="snap-center w-full flex-shrink-0 p-1 md:w-1/2 lg:w-1/4">
                <figure>
                  <div class="h-96">
                    <Img src={`${featuredImage}`} alt={title} />
                  </div>
                  <figcaption class="bg-[#ABC0D1] px-4 py-16">
                    <section class="flex justify-center space-x-4">
                      <div class="flex space-x-2">
                        <img
                          class="w-6 h-6"
                          src="/images/share.svg"
                          alt="Share icon"
                        />
                        <span>300</span>
                      </div>

                      <div class="flex space-x-2">
                        <img
                          class="w-6 h-6"
                          src="/images/heart.svg"
                          alt="Share icon"
                        />
                        <span>128</span>
                      </div>
                    </section>
                    <header class="mt-2">
                      <h3 class="text-center text-xl font-medium">{title}</h3>
                    </header>
                    <p class="line-clamp-4 text-gray-900">{summary}</p>
                    <button class="px-4 py-1 bg-blue-500 text-white rounded-md mx-auto block w-fit mt-4">
                      Read More
                    </button>
                  </figcaption>
                </figure>
              </li>
            );
          })
        }
      </ul>
      <div
        class="h-24 rounded-[50%] w-[125%] top-96 left-1/2 -translate-x-1/2 absolute mx-auto bg-background -translate-y-1/2"
      >
        <h2
          class="text-center absolute top-1/2 -translate-y-1/2 w-full font-alex text-[#264F6E] text-5xl md:text-6xl lg:text-7xl"
        >
          Places to Visit
        </h2>
      </div>
    </div>
  </section>

  <!-- Event & Festivals Section -->
  <section id="events-and-festivals" class="pt-16">
    <header>
      <h1 class="font-alex text-[#264F6E] text-5xl text-center lg:text-7xl">
        Events and Festivals in <span class="text-white">January</span>
      </h1>
    </header>
    <section class="flex flex-wrap container mx-auto mt-8 px-4 lg:px-8">
      <!-- Left -->
      <section class="flex w-full lg:w-1/2">
        <!-- Left -->
        <div class="flex flex-col md:w-1/2">
          <div class="p-2">
            <img
              class="w-full object-cover aspect-square rounded-lg"
              src="/images/places/place1.png"
              alt="test"
            />
          </div>
          <div class="p-8 border-x border-dashed border-black md:mt-48">
            <header class="space-y-2">
              <h2 class="text-3xl">Feast of the Black Nazarene</h2>
              <h3 class="text-2xl text-end font-alex">Januaruy 9</h3>
            </header>
            <p class="px-4">
              This religious festival honors the statue of the Black Nazarene,
              which is believed to have miraculous powers. Devotees from all
              over the Philippines flock to Quiapo Church to touch or kiss the
              statue
            </p>
          </div>
        </div>
        <!-- Right -->
        <div class="w-1/2 flex-col justify-around mt-48 hidden md:flex">
          <div class="p-2">
            <img
              class="w-full object-cover aspect-square rounded-lg"
              src="/images/places/place1.png"
              alt="test"
            />
          </div>
          <div class="mt-72 p-2">
            <img
              class="w-full object-cover aspect-square rounded-lg"
              src="/images/places/place1.png"
              alt="test"
            />
          </div>
        </div>
      </section>

      <!-- Right -->
      <section class="flex w-full lg:w-1/2">
        <!-- Left -->
        <div class="flex flex-col md:w-1/2">
          <div class="p-2 hidden md:block">
            <img
              class="w-full object-cover aspect-square rounded-lg"
              src="/images/places/place1.png"
              alt="test"
            />
          </div>
          <figure class="md:mt-48">
            <div class="p-2">
              <img
                class="w-full object-cover aspect-square rounded-lg"
                src="/images/places/place1.png"
                alt="test"
              />
            </div>
            <figcaption class="p-8 border-x border-dashed border-black">
              <header class="space-y-2">
                <h2 class="text-3xl">Feast of the Black Nazarene</h2>
                <h3 class="text-2xl text-end font-alex">Januaruy 9</h3>
              </header>
              <p class="px-4">
                This religious festival honors the statue of the Black Nazarene,
                which is believed to have miraculous powers. Devotees from all
                over the Philippines flock to Quiapo Church to touch or kiss the
                statue
              </p>
            </figcaption>
          </figure>
        </div>

        <!-- Right -->
        <div class="w-1/2 flex-col justify-around mt-48 hidden md:flex">
          <div class="p-2">
            <img
              class="w-full object-cover aspect-square rounded-lg"
              src="/images/places/place1.png"
              alt="test"
            />
          </div>
          <div class="mt-72 p-2">
            <img
              class="w-full object-cover aspect-square rounded-lg"
              src="/images/places/place1.png"
              alt="test"
            />
          </div>
        </div>
      </section>
    </section>
  </section>

  <!-- TODO: Make the foods and drinks section -->

  <!-- Day Trips Section -->
  <section id="day-trips" class="container mx-auto mt-16">
    <header class="relative lg:px-8">
      <!-- background -->
      <div class="h-56 overflow-hidden lg:rounded-3xl">
        <Img src="/images/day-trips-bg.png" alt="" />
      </div>
      <h1
        class="shadow-xl w-2/3 mx-auto text-center bottom-0 translate-y-1/2 text-[#264F6E] bg-[#BFD7EA] rounded-3xl absolute py-8 left-0 right-0 font-alex text-5xl lg:text-7xl"
      >
        Day Trips
      </h1>
    </header>

    <!-- 1st half -->
    <section class="flex flex-wrap mt-28 px-4 lg:px-8">
      {
        [...tripsCollection].splice(0, 3).map((trip, index) => {
          const { title, summary, featuredImage } = trip.data;
          return (
            <article
              class={`${
                index ? "w-full md:w-1/2 lg:w-1/4" : "w-full lg:w-1/2"
              }`}
            >
              <figure class="px-2">
                <div
                  class={`h-64 ${
                    index ? "overflow-hidden md:rounded-t-3xl" : ""
                  }`}
                >
                  <Img src={featuredImage} alt={title} />
                </div>
                <figcaption class="px-2 w-3/4 mx-auto bg-white relative bottom-10 rounded-t-xl shadow">
                  <header class="border-b border-dashed border-black">
                    <h2 class="text-center font-medium text-xl">Test</h2>
                  </header>
                  <p title={summary} class="p-1 line-clamp-4">
                    {summary}
                  </p>
                </figcaption>
              </figure>
            </article>
          );
        })
      }
    </section>

    <!-- 2nd Half -->
    <section
      class="flex flex-row-reverse flex-wrap px-4 mt-4 lg:px-8 lg:flex-row"
    >
      {
        [...tripsCollection].splice(3, 3).map((trip, index) => {
          const { title, summary, featuredImage } = trip.data;
          return (
            <article
              class={`${
                index
                  ? "w-full md:w-1/2 lg:w-1/4"
                  : "w-full lg:w-1/2 lg:order-3"
              }`}
            >
              <figure class="px-2">
                <div
                  class={`h-64 ${
                    index < 2 ? "overflow-hidden md:rounded-t-3xl" : ""
                  }`}
                >
                  <Img src={featuredImage} alt={title} />
                </div>
                <figcaption class="px-2 w-3/4 mx-auto bg-white relative bottom-10 rounded-t-xl shadow">
                  <header class="border-b border-dashed border-black">
                    <h2 class="text-center font-medium text-xl">Test</h2>
                  </header>
                  <p title={summary} class="p-1 line-clamp-4">
                    {summary}
                  </p>
                </figcaption>
              </figure>
            </article>
          );
        })
      }
    </section>
  </section>

  <!-- Neighborhoods -->
  <section id="neighborhoods" class="mx-auto container mt-8 px-4 lg:px-8">
    <header>
      <h1 class="text-7xl text-[#264F6E] font-alex">Neighborhoods</h1>
    </header>
    <section class="flex flex-row-reverse relative flex-wrap">
      <div class="absolute w-full h-full z-[-1]">
        <Img src="/images/neighborhoods-bg.jpg" alt="" />
      </div>

      <section class="w-full md:w-1/2">
        <article class="p-8">
          <p class="bg-[#2B5F8F] p-2 text-white rounded-xl">
            Manila is the capital city of the Philippines and is known for its
            rich history, diverse culture, and vibrant atmosphere. It is a
            bustling metropolis that serves as the economic, political, and
            cultural center of the country. Manila is a city that seamlessly
            blends its colonial past with its modern present, resulting in a
            unique blend of old and new. The city boasts of numerous historical
            landmarks, world-class museums, delicious cuisine, exciting
            nightlife, and beautiful parks. With its friendly people and warm
            climate, Manila is a popular destination for tourists from all over
            the world.
          </p>
          <button
            class="mx-auto block w-fit py-2 px-4 mt-2 bg-[#A426B8] text-white rounded-md"
            >Explore Manila</button
          >
        </article>
      </section>
      <section
        class="flex font-bold text-white bg-gray-500 bg-opacity-50 w-full md:w-1/2"
      >
        <div class="relative pb-[125%] border w-full">
          <div id="map" class="absolute w-full h-full"></div>
        </div>
        <!-- <div class="relative">
          <img
            class="w-full h-full object-contain"
            src="/images/map2.png"
            alt="map"
          />

          <div class="absolute top-[6%] left-[55%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Caloocan</p>
          </div>

          <div class="absolute top-[25%] left-[55%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Quezon City</p>
          </div>

          <div class="absolute top-[30%] left-[75%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Marikina</p>
          </div>

          <div class="absolute top-[46%] left-[53%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Mandaluyong</p>
          </div>

          <div class="absolute top-[18%] left-[35%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Valenzuela</p>
          </div>

          <div class="absolute top-[25%] left-[28%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Malabon</p>
          </div>

          <div class="absolute top-[40%] left-[35%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Manila</p>
          </div>

          <div class="absolute top-[51%] left-[46%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Makati</p>
          </div>

          <div class="absolute top-[44%] left-[70%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Pasig</p>
          </div>

          <div class="absolute top-[57%] left-[55%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Taguig</p>
          </div>

          <div class="absolute top-[65%] left-[45%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Paranaque</p>
          </div>

          <div class="absolute top-[75%] left-[37%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Las Pinas</p>
          </div>

          <div class="absolute top-[85%] left-[50%] group">
            <div class="h-4 w-4 bg-black rounded-full"></div>
            <p class="z-[1]">Muntinlupa</p>
          </div>
        </div> -->
      </section>
    </section>
  </section>

  <script>
    import L from "leaflet";
    import "leaflet/dist/leaflet.css";
    import metroManilaCities from "@data/metro-manila.json";

    // Create a Leaflet map
    const map = L.map("map").setView([14.6091, 121.0223], 11);

    // Add a TileLayer to the map
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "&copy; Philippines Administrative Boundaries JSON Maps",
    }).addTo(map);

    function getColor(name: string) {
      switch (name) {
        case "Caloocan":
          return "#ff0000";
        case "Manila":
          return "#ff8000";
        case "Mandaluyong":
          return "#ffff00";
        case "Marikina":
          return "#00ff00";
        case "Makati":
          return "#00ffff";
        case "Malabon":
          return "#0000ff";
        case "Muntinlupa":
          return "#8000ff";
        case "Navotas":
          return "#ff00ff";
        case "Parañaque":
          return "#ff0080";
        case "Pasay":
          return "#ff8000";
        case "Pasig":
          return "#ffff00";
        case "Quezon City":
          return "#00ff00";
        case "San Juan":
          return "#00ffff";
        case "Taguig":
          return "#0000ff";
        case "Valenzuela":
          return "#8000ff";
        case "Las Piñas":
          return "#ff00ff";
        case "Muntinlupa":
          return "#ff0080";
        case "Pateros":
          return "#ff8000";
        default:
          return "#000000";
      }
    }

    function style(feature: Record<string, any>) {
      return {
        fillColor: getColor(feature.properties.ADM3_EN),
        weight: 2,
        opacity: 1,
        color: "black",
        dashArray: "3",
        fillOpacity: 0.5,
      };
    }

    L.geoJson(metroManilaCities, { style: style }).addTo(map);
  </script>
</Layout>
